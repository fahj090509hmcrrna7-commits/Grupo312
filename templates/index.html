<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reciclaje Creativo</title>

<style>
body {
    font-family: 'Handlee', cursive;
    background-color: #f0f8ff;
    margin: 0;
    min-height: 100vh;
    width: 100vw;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow-x: hidden;
    position: relative;
}

.bubbles {
    position: fixed;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 0;
}

.bubble {
    position: absolute;
    border-radius: 50%;
    bottom: -150px;
    animation: float 15s infinite ease-in-out, pulseColor 5s infinite alternate;
    box-shadow: inset 0 0 15px rgba(255,255,255,0.6);
}

@keyframes float {
    0% { transform: translateY(0); opacity: 1; }
    100% { transform: translateY(-120vh); opacity: 0; }
}

@keyframes pulseColor {
    0% { background: rgba(144,238,144,0.6); }
    50% { background: rgba(60,179,113,0.8); }
    100% { background: rgba(152,251,152,0.9); }
}

.bubble:nth-child(1){width:40px;height:40px;left:10%;}
.bubble:nth-child(2){width:60px;height:60px;left:30%;}
.bubble:nth-child(3){width:30px;height:30px;left:55%;}
.bubble:nth-child(4){width:50px;height:50px;left:75%;}
.bubble:nth-child(5){width:70px;height:70px;left:5%;}
.bubble:nth-child(6){width:45px;height:45px;left:45%;}
.bubble:nth-child(7){width:55px;height:55px;left:65%;}
.bubble:nth-child(8){width:25px;height:25px;left:85%;}

.container {
    width: 90vw;
    max-width: 900px;
    background: white;
    border: 2px solid #333;
    border-radius: 10px;
    padding: 30px;
    box-shadow: 6px 6px 0 #333;
    z-index: 1;
    margin: 80px 0 20px 0;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 2px solid #333;
    padding-bottom: 15px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 10px;
}

.header-left {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo-container {
    border: 3px dashed #27ae60;
    padding: 5px;
    border-radius: 15px;
    background: #f9f9f9;
}

.title {
    font-size: 40px;
    font-weight: bold;
    color: #27ae60;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
    animation: titlePulse 3s infinite;
}

@keyframes titlePulse {
    0%{transform:scale(1);}
    50%{transform:scale(1.03);}
    100%{transform:scale(1);}
}

.button {
    padding: 12px 20px;
    border-radius: 20px;
    border: 2px solid #333;
    background: linear-gradient(135deg, #7CFC98, #2ecc71);
    cursor: pointer;
    font-weight: bold;
    text-decoration: none;
    color: #333;
    transition: transform .3s, box-shadow .3s;
}

.button:hover {
    transform: scale(1.1);
    box-shadow: 0 0 15px #2ecc71;
}

.btn-juego-toggle {
    background: #ffeb3b;
    border: 2px solid #333;
    padding: 15px;
    width: 100%;
    border-radius: 10px;
    font-weight: bold;

    font-size: 18px;
    cursor: pointer;
    margin-bottom: 15px;
    box-shadow: 4px 4px 0 #333;
}

#seccionJuego {
    display: none;
    background: #fffde7;
    border: 3px solid #333;
    border-radius: 15px;
    padding: 25px;
    margin-bottom: 25px;
    text-align: center;
    box-shadow: 5px 5px 0 #fbc02d;
}

.memory-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    max-width: 400px;
    margin: 20px auto;
}

.card {
    height: 80px;
    background-color: #27ae60;
    border: 2px solid #333;
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 40px;
    cursor: pointer;
    color: transparent;
    transition: transform 0.3s;
}

.card.flipped {
    background-color: white;
    color: initial;
    transform: rotateY(180deg);
}

.card.matched {
    background-color: #a2ffaf;
    color: initial;
    cursor: default;
}

.question {
    background: linear-gradient(135deg, #b9ffcc, #9affb3);
    border-radius: 12px;
    padding: 14px;
    margin-bottom: 15px;
    cursor: pointer;
    font-size: 17px;
    transition: all .4s;
    box-shadow: inset 0 0 10px rgba(0,255,120,0.4);
}

.question:hover {
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(0,255,120,0.8);
}

.muro-ideas {
    margin-top: 30px;
    padding: 20px;
    background: #fdfdfd;
    border: 2px solid #333;
    border-radius: 15px;
}

.idea-card {
    background: white;
    border: 1px solid #ddd;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 8px;
    border-left: 5px solid #27ae60;
    color: #333;
}

.popup-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 10;
}

.popup-box {
    background: linear-gradient(135deg, #eaffea, #b6ffcc);
    padding: 25px;
    width: 80%;
    max-width: 600px;
    border-radius: 20px;
    animation: slideIn .6s ease;
    border: 3px solid #333;
    max-height: 80vh;
    overflow-y: auto;
}

@keyframes slideIn {
    from { transform: translateY(80px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

.popup-close {
    float: right;
    font-size: 22px;
    cursor: pointer;
    font-weight: bold;
}

.img-container-popup {
    margin-top: 15px;
    text-align: center;
    border-top: 2px dashed #27ae60;
    padding-top: 15px;
}

.img-pesta√±a {
    max-width: 100%;
    height: auto;
    border-radius: 10px;
    border: 3px solid #333;
    background: white;
}
</style>
</head>

<body>

<div style="background: yellow; color: black; padding: 10px; position: fixed; top: 0; width: 100%; z-index: 100; text-align: center; border-bottom: 2px solid black; display: flex; justify-content: center; align-items: center; gap: 20px;">
  <span>DEBUG: Hay {{ usuarios|length }} usuarios en la base de datos.</span>
  <button onclick="toggleAudio()" id="btnAudio" style="background: white; border: 1px solid black; cursor: pointer; padding: 2px 10px; font-weight: bold; border-radius: 5px;">üçÉ Audio: OFF</button>
  <audio id="musicaOculta" loop>
      <source src="https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3" type="audio/mpeg">
  </audio>
</div>

<div class="bubbles">
    <div class="bubble"></div><div class="bubble"></div><div class="bubble"></div>
    <div class="bubble"></div><div class="bubble"></div><div class="bubble"></div>
</div>

<div class="container">

    <div class="header">
        <div class="header-left">
            <div class="logo-container">
                <img src="{{ url_for('static', filename='img/miazul.png') }}" width="90" alt="Logo">
            </div>
            <span class="title">Reciclaje Creativo</span>
        </div>
        
        <div class="header-right">
            {% if session.get('usuario_id') %}
                <span style="margin-right: 10px; color: #27ae60;">Hola, <b>{{ session['usuario_nombre'] }}</b>!</span>
                <a href="/logout" class="button" style="background: #ff7675; border-color: #333;">‚ùå Salir</a>
            {% else %}
                <a href="/unirse" class="button">‚ú® Registrarse</a>
            {% endif %}
        </div>
    </div>

    <div class="question" onclick="openPopup('El <b>reciclaje</b> es el proceso de transformar materiales que ya no utilizamos en nuevas materias primas. Es la forma m√°s efectiva de evitar que nuestros desechos terminen contaminando r√≠os, mares o suelos, d√°ndoles una <b>segunda vida</b> √∫til.<br><br><b>¬øPor qu√© es importante?</b><br>‚Ä¢ <b>Ahorro de energ√≠a:</b> Fabricar productos con materiales reciclados consume mucha menos energ√≠a que extraer recursos nuevos.<br>‚Ä¢ <b>Protecci√≥n ambiental:</b> Al reciclar papel salvamos bosques, y al reciclar metales reducimos la miner√≠a agresiva.<br>‚Ä¢ <b>Menos basura:</b> Ayuda a que los vertederos no se llenen tan r√°pido, reduciendo la contaminaci√≥n.<br><br><b>El ciclo del √©xito:</b><br>Todo empieza con la <b>separaci√≥n correcta</b> en casa; sin ese primer paso, los materiales se ensucian y ya no pueden ser transformados. Reciclar es un acto de respeto hacia nuestro planeta.', 'foto1.jpg')">¬øQu√© es el reciclaje?</div>
    
    <div class="question" onclick="openPopup('Existen diferentes formas de clasificar el reciclaje seg√∫n el material y el proceso, pero los m√°s comunes son:<br><br>‚Ä¢ <b>Pl√°stico (Amarillo):</b> Se clasifican por c√≥digos del 1 al 7. Reciclar una botella de pl√°stico ahorra suficiente energ√≠a para mantener una bombilla encendida por 6 horas.<br>‚Ä¢ <b>Papel y Cart√≥n (Azul):</b> Por cada tonelada de papel reciclado, se salvan 17 √°rboles y se ahorran miles de litros de agua.<br>‚Ä¢ <b>Vidrio (Verde):</b> Es el material perfecto porque se puede reciclar al 100% infinitas veces sin perder su calidad.<br>‚Ä¢ <b>Org√°nico (Marr√≥n):</b> Consiste en reciclar restos de comida para crear compost (abono natural) para la tierra.<br><br><b>Reciclaje Especial:</b><br>Tambi√©n existe el reciclaje de <b>metales</b> (latas), <b>electr√≥nicos</b> (pilas y cables) y <b>textil</b>.', 'foto2.jpg')">¬øCu√°ntos tipos de reciclaje hay?</div>
    
    <div class="question" onclick="openPopup('El reciclaje es una de las herramientas m√°s poderosas que tenemos para proteger el planeta. Sus beneficios impactan directamente en la salud del ecosistema:<br><br>‚Ä¢ <b>Conservaci√≥n de recursos:</b> Al reciclar, evitamos la extracci√≥n de nuevas materias primas, lo que significa menos deforestaci√≥n y menos excavaciones mineras que destruyen habbitats naturales.<br>‚Ä¢ <b>Ahorro de energ√≠a y agua:</b> Producir objetos desde materiales reciclados gasta hasta un 90% menos de energ√≠a y reduce dr√°sticamente el consumo de agua industrial.<br>‚Ä¢ <b>Reducci√≥n de gases de efecto invernadero:</b> Al usar menos energ√≠a en las f√°bricas, se emite mucho menos CO2, ayudando directamente a frenar el cambio clim√°tico.<br>‚Ä¢ <b>Protecci√≥n de la fauna:</b> Evita que pl√°sticos y qu√≠micos terminen en los oc√©anos, salvando la vida de miles de tortugas, aves y peces.', 'foto3.jpg')">¬øEn qu√© ayuda al medio ambiente?</div>
    
    <div class="question" onclick="openPopup('Si dejamos de reciclar, las consecuencias para nuestro entorno lamento ser√≠an catastr√≥ficas a corto y largo plazo:<br><br>‚Ä¢ <b>Colapso de vertederos:</b> Los basureros alcanzar√≠an su capacidad m√°xima r√°pidamente, obligando a crear nuevos dep√≥sitos en zonas naturales.<br>‚Ä¢ <b>Agotamiento de recursos:</b> Tendr√≠amos que extraer recursos naturales sin descanso. Esto causar√≠a la desaparici√≥n de bosques enteros.<br>‚Ä¢ <b>Aumento de la contaminaci√≥n:</b> La fabricaci√≥n de productos desde cero emite mucho m√°s gases t√≥xicos.<br>‚Ä¢ <b>Mares de pl√°stico:</b> Millones de toneladas de desechos terminar√≠an en los oc√©anos, creando islas de basura gigantes.', 'foto4.jpg')">¬øQu√© pasa si no reciclamos?</div>
    
    <div class="question" onclick="openPopup('¬°El reciclaje puede ser un arte! Aqu√≠ tienes algunas ideas incre√≠bles para transformar residuos en objetos √∫tiles:<br><br>‚Ä¢ <b>Macetas con personalidad:</b> Corta botellas de pl√°stico a la mitad y p√≠ntalas. <a href=\'#\'>Ver video aqu√≠</a><br>‚Ä¢ <b>Organizadores de escritorio:</b> Usa latas de conservas decoradas.<br>‚Ä¢ <b>L√°mparas modernas:</b> Con botellas de vidrio.<br>‚Ä¢ <b>Juguetes ecol√≥gicos:</b> Crea alcanc√≠as con botes de champ√∫. <a href=\'#\'>Ver ideas de animales</a><br><br><b>¬øPor qu√© hacerlo?</b><br>Hacer manualidades ahorra dinero y estimula la creatividad.', 'foto5.jpg')">¬øQu√© cosas creativas podemos hacer?</div>

    <button class="btn-juego-toggle" onclick="toggleJuego()">üéÆ pulse para jugar el ECO-MEMORAMA</button>
    <div id="seccionJuego">
        <h3 style="margin-top:0;">üåü MEMORAMA: ¬°Encuentra los Pares!</h3>
        <p>Encuentra los materiales iguales para limpiar el tablero.</p>
        <div class="memory-grid" id="grid"></div>
        <p id="msgJuego" style="margin-top:15px; font-weight:bold; height:20px; color: #27ae60;"></p>
        <button onclick="resetMemorama()" style="padding: 5px 15px; cursor: pointer; border-radius: 5px; border: 1px solid #333;">Reiniciar Juego</button>
    </div>

    <div class="muro-ideas">
        <h3 style="color: #27ae60; border-bottom: 2px solid #27ae60; padding-bottom: 5px;">üí¨ Ideas de la Comunidad</h3>
        {% if usuarios %}
            {% for u in usuarios %}
                <div class="idea-card"><strong>{{ u.nombre }}:</strong> "{{ u.comentario }}"</div>
            {% endfor %}
        {% endif %}
    </div>

</div>

<div class="popup-overlay" id="popup">
    <div class="popup-box">
        <span class="popup-close" onclick="closePopup()">‚úñ</span>
        <div id="popupText"></div>
        <div class="img-container-popup">
            <img src="" id="popupImg" class="img-pesta√±a" onerror="this.src='https://via.placeholder.com/300?text=Sube+tu+foto+a+static/img'">
        </div>
    </div>
</div>

<script>
function openPopup(text, imageName){
    document.getElementById("popupText").innerHTML = text;
    document.getElementById("popupImg").src = "/static/img/" + imageName;
    document.getElementById("popup").style.display = "flex";
}
function closePopup(){ document.getElementById("popup").style.display = "none"; }

function toggleJuego() {
    var x = document.getElementById("seccionJuego");
    if (x.style.display === "none" || x.style.display === "") {
        x.style.display = "block";
        resetMemorama();
    } else {
        x.style.display = "none";
    }
}

const icons = ['üçæ', 'üì¶', 'üîã', 'üì∞', 'ü•§', 'üçé', 'üçæ', 'üì¶', 'üîã', 'üì∞', 'ü•§', 'üçé'];
let flippedCards = [];
let matchedCount = 0;

function resetMemorama() {
    const grid = document.getElementById('grid');
    grid.innerHTML = '';
    flippedCards = [];
    matchedCount = 0;
    document.getElementById('msgJuego').innerText = "";
    
    // Mezclar iconos
    const shuffled = icons.sort(() => 0.5 - Math.random());
    
    shuffled.forEach((icon, index) => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.dataset.icon = icon;
        card.innerText = icon;
        card.onclick = () => flipCard(card);
        grid.appendChild(card);
    });
}

function flipCard(card) {
    if (flippedCards.length < 2 && !card.classList.contains('flipped') && !card.classList.contains('matched')) {
        card.classList.add('flipped');
        flippedCards.push(card);
        
        if (flippedCards.length === 2) {
            checkMatch();
        }
    }
}

function checkMatch() {
    const [card1, card2] = flippedCards;
    if (card1.dataset.icon === card2.dataset.icon) {
        card1.classList.add('matched');
        card2.classList.add('matched');
        flippedCards = [];
        matchedCount += 2;
        if (matchedCount === icons.length) {
            document.getElementById('msgJuego').innerText = "¬°FELICIDADES! Planeta Limpio üåç‚ú®";
        }
    } else {
        setTimeout(() => {
            card1.classList.remove('flipped');
            card2.classList.remove('flipped');
            flippedCards = [];
        }, 1000);
    }
}

function toggleAudio() {
    var a = document.getElementById("musicaOculta");
    var b = document.getElementById("btnAudio");
    if (a.paused) { a.play(); b.innerHTML = "üîä Audio: ON"; b.style.background = "#81c784"; }
    else { a.pause(); b.innerHTML = "üçÉ Audio: OFF"; b.style.background = "white"; }
}
</script>
</body>
</html>
